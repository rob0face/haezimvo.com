@if (results.length > 0) {
  <mat-card>
    <div class="table-wrapper">
      <mat-table [dataSource]="results" class="mat-elevation-z2">

      <!-- 선사 -->
      <ng-container matColumnDef="선사">
        <mat-header-cell *matHeaderCellDef> 선사 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.CARRIER }} </mat-cell>
      </ng-container>

      <!-- 출발지 -->
      <ng-container matColumnDef="출발지">
        <mat-header-cell *matHeaderCellDef> 출발지 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.ORIGIN }} </mat-cell>
      </ng-container>

      <!-- 도착지 -->
      <ng-container matColumnDef="도착지">
        <mat-header-cell *matHeaderCellDef> 도착지 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.DESTINATION }} </mat-cell>
      </ng-container>

      <!-- 20STD 운임 -->
      <ng-container matColumnDef="20STD 운임">
        <mat-header-cell *matHeaderCellDef> 20STD 운임 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.FARE_20STD }} </mat-cell>
      </ng-container>

      <!-- 40HC 운임 -->
      <ng-container matColumnDef="40HC 운임">
        <mat-header-cell *matHeaderCellDef> 40HC 운임 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.FARE_40HC }} </mat-cell>
      </ng-container>

      <!-- 운임 만료 -->
      <ng-container matColumnDef="운임 만료">
        <mat-header-cell *matHeaderCellDef> 운임 만료 </mat-header-cell>
        <mat-cell *matCellDef="let element"> {{ element.VALID_UNTIL }} </mat-cell>
      </ng-container>

      <!-- 수수료 -->
      <ng-container matColumnDef="수수료">
        <mat-header-cell *matHeaderCellDef> 수수료 </mat-header-cell>
        <mat-cell *matCellDef="let row">
          @if (getValidFees(row).length > 0) {
            <mat-accordion>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>보기</mat-panel-title>
                </mat-expansion-panel-header>
                @for (fee of getValidFees(row); track $index) {
                  <p>
                    <strong>{{ fee.name }}</strong>
                    (단위: {{ fee.unit }})
                    {{ fee.amount }} {{ fee.currency }}
                  </p>
                }
              </mat-expansion-panel>
            </mat-accordion>
          }
        </mat-cell>
      </ng-container>

      <!-- 헤더와 로우 -->
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;">
        @if (getValidFees(row).length > 0) {
            <mat-accordion>
              <mat-expansion-panel>
                <mat-expansion-panel-header>
                  <mat-panel-title>수수료</mat-panel-title>
                </mat-expansion-panel-header>
                @for (fee of getValidFees(row); track $index) {
                  <p>
                    <strong>{{ fee.name }}</strong>
                    (단위: {{ fee.unit }})
                    {{ fee.amount }} {{ fee.currency }}
                  </p>
                }
              </mat-expansion-panel>
            </mat-accordion>
          }
        </mat-row>
      </mat-table>
    </div>
</mat-card>
} @else {
    <mat-card>
      <p>😢 검색 결과가 없습니다. 조건을 다시 확인해보세요.</p>
    </mat-card>
}
